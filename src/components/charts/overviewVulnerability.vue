<template>
  <div :class="className" :id="id" :style="{height:height,width:width}"></div>
</template>

<script>
  // http://echarts.baidu.com/examples/editor.html?c=bar-y-category-stack
    import echarts from 'echarts'
    import { debounce } from '@/utils'
    export default {
      props: {
        className: {
          type: String,
          default: 'chart'
        },
        id: {
          type: String,
          default: 'chart'
        },
        width: {
          type: String,
          default: '200px'
        },
        height: {
          type: String,
          default: '200px'
        }
      },
      data() {
        return {
          chart: null,
          option: {
            tooltip: {
              trigger: 'axis',
              axisPointer: {
                type: 'shadow'
              }
            },
            legend: {
              data: ['高危', '中危', '底危', '信息', '未定义'],
              left: 90,
              textStyle: {
                color: '#4676FF',
                fontSize: '15'
              }
            },
            grid: {
              left: '3%',
              right: '4%',
              bottom: '3%',
              containLabel: true
            },
            xAxis: {
              type: 'value',
              splitLine: {
                show: true,
                lineStyle: {
                  color: 'rgba(70, 118, 255, 0.2)'
                }
              },
              axisLine: {
                lineStyle: {
                  color: '#4676FF'
                }
              },
              axisLabel: {
                textStyle: {
                  color: '#4676FF',
                  fontSize: '15'
                }
              },
              axisTick: {
                lineStyle: {
                  color: '#4676FF'
                }
              }
            },
            yAxis: {
              type: 'category',
              data: ['业务一', '业务二', '业务三', '业务四', '业务五', '业务六', '业务七'],
              splitLine: {show: false},
              axisLine: {
                lineStyle: {
                  color: '#4676FF'
                }
              },
              axisLabel: {
                textStyle: {
                  color: '#4676FF',
                  fontSize: '15'
                }
              },
              axisTick: {
                lineStyle: {
                  color: '#4676FF'
                }
              }
            },
            series: [
              {
                name: '高危',
                type: 'bar',
                stack: '总量',
                label: {
                  normal: {
                    show: true,
                    position: 'insideRight'
                  }
                },
                data: [320, 302, 301, 334, 390, 330, 320]
              },
              {
                name: '中危',
                type: 'bar',
                stack: '总量',
                label: {
                  normal: {
                    show: true,
                    position: 'insideRight'
                  }
                },
                data: [120, 132, 101, 134, 90, 230, 210]
              },
              {
                name: '低危',
                type: 'bar',
                stack: '总量',
                label: {
                  normal: {
                    show: true,
                    position: 'insideRight'
                  }
                },
                data: [220, 182, 191, 234, 290, 330, 310]
              },
              {
                name: '信息',
                type: 'bar',
                stack: '总量',
                label: {
                  normal: {
                    show: true,
                    position: 'insideRight'
                  }
                },
                data: [150, 212, 201, 154, 190, 330, 410]
              },
              {
                name: '未定义',
                type: 'bar',
                stack: '总量',
                label: {
                  normal: {
                    show: true,
                    position: 'insideRight'
                  }
                },
                data: [820, 832, 901, 934, 1290, 1330, 1320]
              }
            ]
          }
        }
      },
      mounted() {
        this.initChart()
        this.__resizeHanlder = debounce(() => {
          if (this.chart) {
            this.chart.resize()
          }
        }, 50)
        window.addEventListener('resize', this.__resizeHanlder)
      },
      beforeDestroy() {
        if (!this.chart) {
          return
        }
        this.chart.dispose()
        this.chart = null
      },
      methods: {
        initChart() {
          this.chart = echarts.init(document.getElementById(this.id))
          this.chart.setOption(this.option)
        }
      }
    }
</script>

<style scoped>

</style>
